/************************************************************************/
/*                                                                      */
/* INCLUDE                                                              */
/*                                                                      */
/************************************************************************/
#include "criticalsection.h"

#define WIN32_LEAN_AND_MEAN
#include <Windows.h>

/************************************************************************/
/*                                                                      */
/* DEFINES AND CONSTANTS                                                */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* MACROS                                                               */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* TYPES                                                                */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* STRUCTS                                                              */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* CLASSES                                                              */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* LOCAL VARIABLES                                                      */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* GLOBAL VARIABLES                                                     */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* LOCAL FUNCTIONS                                                      */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* EXTERNAL FUNCTIONS                                                   */
/*                                                                      */
/************************************************************************/
//------------------------------------------------------------------------
CriticalSection::CriticalSection()
{
   ::InitializeCriticalSection( &cs );
}

//------------------------------------------------------------------------
CriticalSection::~CriticalSection()
{
   ::DeleteCriticalSection( &cs );
}

//------------------------------------------------------------------------
void CriticalSection::lock()
{
   ::EnterCriticalSection( &cs );
}

//------------------------------------------------------------------------
bool CriticalSection::try_lock()
{
   return TRUE == ::TryEnterCriticalSection( &cs );
   return false;
}

//------------------------------------------------------------------------
void CriticalSection::unlock()
{
   ::LeaveCriticalSection( &cs );
}

//------------------------------------------------------------------------
//------------------------------------------------------------------------
ScopeCriticalSection::ScopeCriticalSection( CriticalSection *ptr ) 
{
   cs_ptr = ptr;
   cs_ptr->lock();
}

//------------------------------------------------------------------------
ScopeCriticalSection::~ScopeCriticalSection()
{
   cs_ptr->unlock();
}

/************************************************************************/
/*                                                                      */
/* COMMANDS                                                             */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* UNIT TESTS                                                           */
/*                                                                      */
/************************************************************************/


